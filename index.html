<!DOCTYPE html>
<html>
<head>
<title>Humus Simulator/Debugger</title>
<style>
#script {
	color: #003;
	background: #FFC;
	margin: 1em;
	border: solid 1px #CCC;
}
#debug {
	color: #C00;
	background: #EEE;
	padding: 0 0.5em;
	display: none;
}
#trace {
	color: #00C;
	padding: 0 0.5em;
	display: none;
}
</style>
</head>
<body>

<div style="float:right">
<div style="margin:.5em;">
<button id="halt-btn" onclick="halt_runtime();">Halt</button>
</div>
</div>

<h1><a href="http://dalnefre.com/wp/humus/">Humus</a> Simulator/Debugger</h1>

<pre id="output"></pre>

<button id="exec-btn" onclick="exec_script('script');">Execute</button>

<form id="editor" action="#">
<textarea id="script" name="script" rows="60" cols="72"></textarea>
</form>

<pre id="log"></pre>

<div style="margin:.5em;">
<button id="debug-btn" onclick="toggle_display('debug');">Debug</button>
<button id="trace-btn" onclick="toggle_display('trace');">Trace</button>
<button id="meta-btn" onclick="select_meta();">Meta</button>
<button id="json-btn" onclick="select_json();">Json</button>
</div>

<pre id="debug">
DEBUG:
</pre>
<pre id="trace">
TRACE:
</pre>

</body>

<script type="module">
import core from "./core.js";
import Humus from "./humus.js";
import gen_json from "./gen_json.js";
import gen_meta from "./gen_meta.js";
import hum_runtime from "./hum_runtime.js";

window.runtime = hum_runtime(gen_meta);
window.select_meta = function () {
	window.runtime = hum_runtime(gen_meta);
};
window.select_json = function () {
	window.runtime = hum_runtime(gen_json);
};
window.exec_script = function (id) {
	window.runtime.execute(id);
};
window.halt_runtime = function () {
	var el;

	el = core.id('halt-btn');
	if (el) { el.value = 'Halting'; }
	window.runtime.config.halt();
	if (el) { el.value = 'Halted'; }
	core.println(core.id('output'), '--RUNTIME-HALTED--');
};
window.toggle_display = function (id) {
	var el, s;

	el = core.id(id || 'debug');
	if (el) {
		s = el.style;
		if (s.display === 'block') {
			s.display = 'none';
		} else {
			s.display = 'block';
		}
	}
};
</script>
</html>
